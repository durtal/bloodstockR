<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<title>Tattersalls</title>

<script src="libs/jquery-1.11.0/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.1/css/united.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.1/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.1/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.1/shim/respond.min.js"></script>

<style type="text/css">

/* padding for bootstrap navbar */
body {
  padding-top: 20px;
  padding-bottom: 20px;
}
@media (max-width: 979px) {
  body {
    padding-top: 0;
  }
}

/* offset scroll position for anchor links (for fixed navbar)  */
@media (min-width: 980px) {
  .section h2 {
    padding-top: 52px;
    margin-top: -52px;
  }
  .section h3 {
    padding-top: 52px;
    margin-top: -52px;
  }
}

p{
  font-size: 13px;
}
/* don't use link color in navbar */
.dropdown-menu>li>a {
  color: black;
}

/* some padding for disqus */
#disqus_thread {
  margin-top: 45px;
}

</style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img { 
  max-width:100%; 
  height: auto; 
}
</style>
<div class="container-fluid main-container">

<h1>bloodstockR</h1>
<nav class="navbar navbar-inverse">
	<div class="container-fluid">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" href="https://github.com/durtal">durtal@github</a>
		</div>

		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			<ul class="nav navbar-nav">
				<li>
					<a href="index.html">Home</a>
				</li>
				<li class="dropdown">
					<a href="Datasets" class="dropdown-toggle" data-toggle="dropdown">
						Datasets <b class="caret"></b>
					</a>
					<ul class="dropdown-menu">
						<li>
							<a href="tattersalls.html">Tattersalls</a>
						</li>
					</ul>
				</li>
				<li class="dropdown">
					<a href="functions" class="dropdown-toggle" data-toggle="dropdown">
						Functions <b class="caret"></b>
					</a>
					<ul class="dropdown-menu">
						<li>
							<a href="collect_tatts_sales.html">collect_tatts_sales</a>
						</li>
					</ul>
				</li>
			</ul>
		</div>
	</div>
</nav>

<div id="header">
<h1 class="title">Tattersalls</h1>
</div>


<p>There are currently (as of 2016-04-15) 6 datasets with Tattersalls sales data, these are:</p>
<table>
<thead>
<tr class="header">
<th align="left">Name</th>
<th align="left">Sales included</th>
<th align="left">Dim</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">tatts_2010</td>
<td align="left"><sub>feb, craven, guineas, july, oct_bk1, oct_bk2, oct_bk3, autumn_hit, breeders_flat, dec_yearlings, dec_foals, dec_mares</sub></td>
<td align="left">7796 rows, 12 cols</td>
</tr>
<tr class="even">
<td align="left">tatts_2011</td>
<td align="left"><sub>feb, craven, breeze_up, july, oct_bk1, oct_bk2, oct_bk3, autumn_hit, breeders_flat, dec_yearlings, dec_foals, dec_mares</sub></td>
<td align="left">6946 rows, 12 cols</td>
</tr>
<tr class="odd">
<td align="left">tatts_2012</td>
<td align="left"><sub>dec_mares, dec_foals, dec_yearlings, autumn_hit, oct_bk3, oct_bk2, oct_bk1, july, guineas_hit, guineas, craven, feb</sub></td>
<td align="left">7101 rows, 12 cols</td>
</tr>
<tr class="even">
<td align="left">tatts_2013</td>
<td align="left"><sub>feb, craven, guineas, guineas_hit, july, oct_bk1, oct_bk2, oct_bk3, oct_bk4, autumn_hit, dec_yearlings, dec_foals, dec_mares</sub></td>
<td align="left">7192 rows, 12 cols</td>
</tr>
<tr class="odd">
<td align="left">tatts_2014</td>
<td align="left"><sub>july, guineas, guineas_hit, craven, feb, oct_bk1, oct_bk2, oct_bk3, oct_bk4, autumn_hit, dec_yearlings, dec_foals, dec_mares</sub></td>
<td align="left">7429 rows, 12 cols</td>
</tr>
<tr class="even">
<td align="left">tatts_2015</td>
<td align="left"><sub>feb, craven, guineas, guineas_hit, july, oct_bk1, oct_bk2, oct_bk3, oct_bk4, autumn_hit</sub></td>
<td align="left">5389 rows, 12 cols</td>
</tr>
</tbody>
</table>
<p>There is a function to collect data from sales not included in the package, see <a href="collect_tatts_sales.html">here</a>.</p>
<p>To load a dataset:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(tatts_2010)</code></pre>
<p>Each of the 5 datasets have the same 12 variables, <code>year, sale, sale_name, lot_no, horse, sex, color, sire, dam, seller, buyer, price</code>, as can be seen in the table above, the same sales take place each year.</p>
<div id="some-analysis" class="section level3">
<h3>Some Analysis</h3>
<p>It is easy to combine the 5 datasets, such as:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(tatts_2010, tatts_2011, tatts_2012, tatts_2013, tatts_2014)

<span class="co"># combine all 5 datasets into one large dataset</span>
tattersalls &lt;-<span class="st"> </span><span class="kw">rbind</span>(tatts_2010, tatts_2011, tatts_2012, tatts_2013, tatts_2014)
<span class="co"># clean workspace</span>
<span class="kw">rm</span>(tatts_2010, tatts_2011, tatts_2012, tatts_2013, tatts_2014)</code></pre>
<p>The new <code>tattersalls</code> dataset has 36464 rows and 12 columns, the <code>sale_name</code> variable can serve as an individual sale (so it includes the year of the sale, eg. <strong>feb_2010</strong>), while the <code>sale</code> variable will match across multiple years.</p>
<p>Loading other libraries <code>dplyr</code> and <code>ggplot2</code> we can quickly analyse data:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">library</span>(ggplot2)</code></pre>
<p>The average price of lots in each sale across multiple years:</p>
<pre class="sourceCode r"><code class="sourceCode r">sale_summaries &lt;-<span class="st"> </span>tattersalls %&gt;%
<span class="st">    </span><span class="kw">group_by</span>(sale, year) %&gt;%
<span class="st">    </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>(),
              <span class="dt">mean =</span> <span class="kw">mean</span>(price, <span class="dt">na.rm=</span>T))

<span class="kw">ggplot</span>(sale_summaries, <span class="kw">aes</span>(<span class="dt">x=</span>year, <span class="dt">y=</span>mean)) +
<span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;#D9220F&quot;</span>) +
<span class="st">    </span><span class="kw">theme_bw</span>() +
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) +
<span class="st">    </span><span class="kw">facet_wrap</span>(~sale)</code></pre>
<p><img src="tattersalls_files/figure-html/unnamed-chunk-5-1.png" title="" alt="" width="864" style="display: block; margin: auto;" /></p>
<p>One thing stands out immediately from the plots above, donâ€™t go to October Book 1 unless you have deep pockets, the average price paid has more than doubled from 96,001 Guineas in 2010 to 212,637 Guineas in 2014. October Book 2 has also (unsurprisingly) seen a small increase in average price paid over the same period. The Craven sale has also seen a small increase over recent years, but prices are in other sales appear to be quite consistent.</p>
<p>We can also find the 20 sires with the highest average price over the 5 years:</p>
<pre class="sourceCode r"><code class="sourceCode r">tattersalls %&gt;%
<span class="st">    </span><span class="kw">group_by</span>(sire) %&gt;%
<span class="st">    </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>(),
              <span class="dt">mean =</span> <span class="kw">mean</span>(price, <span class="dt">na.rm=</span>T),
              <span class="dt">sd =</span> <span class="kw">sd</span>(price, <span class="dt">na.rm=</span>T),
              <span class="dt">min =</span> <span class="kw">min</span>(price, <span class="dt">na.rm=</span>T),
              <span class="dt">max =</span> <span class="kw">max</span>(price, <span class="dt">na.rm=</span>T)) %&gt;%
<span class="st">    </span><span class="kw">filter</span>(n &gt;=<span class="st"> </span><span class="dv">50</span>) %&gt;%
<span class="st">    </span><span class="kw">arrange</span>(<span class="kw">desc</span>(mean)) %&gt;%
<span class="st">    </span><span class="kw">head</span>(<span class="dv">20</span>)</code></pre>
<pre><code>## Source: local data frame [20 x 6]
## 
##                       sire     n      mean        sd   min     max
##                      (chr) (int)     (dbl)     (dbl) (dbl)   (dbl)
## 1            galileo (ire)   572 211314.35 409799.91   800 5000000
## 2      sea the stars (ire)   182 199763.89 150603.40  6000  650000
## 3           danehill (usa)    52 124195.56 379083.76  2000 2400000
## 4       new approach (ire)   238 108774.87 110347.56  2500  600000
## 5            montjeu (ire)   326 105223.87 156474.57   800  850000
## 6             dubawi (ire)   372  97881.49 169775.01   800 1600000
## 7     sadler&#39;s wells (usa)   156  96807.09 201949.61  1000 1700000
## 8         oasis dream (gb)   594  94710.82 143449.05   800 1100000
## 9             monsun (ger)    84  93459.70 109112.35  2000  600000
## 10            dansili (gb)   434  84944.14 184443.84   800 2700000
## 11      fastnet rock (aus)   154  83655.46  84648.97  4000  540000
## 12      raven&#39;s pass (usa)   140  81896.75 104884.44   800  800000
## 13   danehill dancer (ire)   499  80129.26 227178.69   800 4000000
## 14 invincible spirit (ire)   653  80056.97 128397.23   800 2100000
## 15      lope de vega (ire)    83  75378.38  98854.63  1000  650000
## 16            pivotal (gb)   630  72477.19 225981.29   800 4700000
## 17             lawman (fr)   281  70083.76 301039.09   800 4500000
## 18         shamardal (usa)   478  69765.14 118171.36   800 1700000
## 19       poet&#39;s voice (gb)   105  69760.64 104033.18  3500  700000
## 20    rip van winkle (ire)   130  68780.37  65442.26  4000  400000</code></pre>
<p><strong>Sea The Stars</strong> is top of the list, his progeny costing a cool 224,100 Guineas on average, Galileo is a very close second, with a large drop down, of almost 100,000 Guineas, to Danehill. Perhaps more interesting than Sea The Stars topping Galileo is the <em>standard deviation</em> of their prices, Sea The Stars with a much smaller <strong>sd</strong> perhaps suggests buyers believe his progeny will prove to be successful (see Taghrooda), but are still showing some restraint and arenâ€™t quite willing to part with the big sums seen with Galileo, whose most expensive sale fetched 9 times the most expensive Sea The Stars sale.</p>
<p>Itâ€™s also possible to look at the buyers or agents with the highest average price paid over the 5years.</p>
<pre class="sourceCode r"><code class="sourceCode r">tattersalls %&gt;%
<span class="st">    </span><span class="kw">group_by</span>(buyer) %&gt;%
<span class="st">    </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>(),
              <span class="dt">mean =</span> <span class="kw">mean</span>(price, <span class="dt">na.rm=</span>T),
              <span class="dt">sd =</span> <span class="kw">sd</span>(price, <span class="dt">na.rm=</span>T),
              <span class="dt">min =</span> <span class="kw">min</span>(price, <span class="dt">na.rm=</span>T),
              <span class="dt">max =</span> <span class="kw">max</span>(price, <span class="dt">na.rm=</span>T)) %&gt;%
<span class="st">    </span><span class="kw">filter</span>(n &gt;=<span class="st"> </span><span class="dv">50</span>) %&gt;%
<span class="st">    </span><span class="kw">arrange</span>(<span class="kw">desc</span>(mean)) %&gt;%
<span class="st">    </span><span class="kw">head</span>(<span class="dv">20</span>)</code></pre>
<pre><code>## Source: local data frame [20 x 6]
## 
##                            buyer     n      mean        sd   min     max
##                            (chr) (int)     (dbl)     (dbl) (dbl)   (dbl)
## 1                   demi o&#39;byrne    51 342019.61 264811.14  6000 1300000
## 2       john ferguson bloodstock   314 215003.18 296659.68 25000 4000000
## 3            j warren bloodstock    86 176343.02 146367.91 16500  680000
## 4        shadwell estate company   234 173025.64 135849.13 35000 1100000
## 5     c gordon-watson bloodstock   281 149810.68 196409.25   800 1700000
## 6       david redvers bloodstock   202 121936.63 223385.67  5000 2500000
## 7         john warren bloodstock    93 118645.16  95735.10 11000  600000
## 8             badgers bloodstock    53 118452.83 159747.10 10000  800000
## 9                   dwayne woods    59  95652.54  79130.74  3000  450000
## 10             mrs a skiffington    63  81595.24  80855.60  3000  400000
## 11          blandford bloodstock   452  80300.00 103073.80   800  925000
## 12               jeremy brummitt    67  78544.78  85540.03  6500  475000
## 13     anthony stroud bloodstock   242  75130.17  74083.30   800  425000
## 14     richard frisby bloodstock    90  72338.89  83634.50  2000  370000
## 15     brian grassick bloodstock    52  70176.92  61604.80  2200  360000
## 16 peter &amp; ross doyle bloodstock   382  68610.47  76552.10   800  800000
## 17         hugo merry bloodstock   141  68357.45  92076.88  1700  675000
## 18     stephen hillen bloodstock   171  67578.95 167784.40  3000 2100000
## 19               sackvilledonald   191  66107.33  58515.52  2500  460000
## 20  kern/lillingston association   139  57712.23  70722.67  3800  460000</code></pre>
<p>Demi Oâ€™Byrne (an agent associated with Coolmore) isnâ€™t as active as others in the top 5, with just 50 purchases, but the average price he pays is almost double that of John Ferguson (links with Godolphin).</p>
<a href="https://github.com/durtal/bloodstockR" class="github-corner"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#d9230f; color:#fcfcfc; position: absolute; top: 0; border: 0; right: 0;"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>
<style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>


</body>
</html>
