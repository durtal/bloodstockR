<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<title>Tattersalls</title>

<script src="libs/jquery-1.11.0/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link href="libs/bootstrap-2.3.2/css/united.min.css" rel="stylesheet" />
<link href="libs/bootstrap-2.3.2/css/bootstrap-responsive.min.css" rel="stylesheet" />
<script src="libs/bootstrap-2.3.2/js/bootstrap.min.js"></script>

<style type="text/css">

/* padding for bootstrap navbar */
body {
  padding-top: 50px;
  padding-bottom: 40px;
}
@media (max-width: 979px) {
  body {
    padding-top: 0;
  }
}

/* offset scroll position for anchor links (for fixed navbar)  */
@media (min-width: 980px) {
  .section h2 {
    padding-top: 52px;
    margin-top: -52px;
  }
  .section h3 {
    padding-top: 52px;
    margin-top: -52px;
  }
}

p{
  font-size: 13px;
}
/* don't use link color in navbar */
.dropdown-menu>li>a {
  color: black;
}

/* some padding for disqus */
#disqus_thread {
  margin-top: 45px;
}

</style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #303030; color: #cccccc; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; }
td.sourceCode { padding-left: 5px; }
pre, code { color: #cccccc; background-color: #303030; }
code > span.kw { color: #f0dfaf; }
code > span.dt { color: #dfdfbf; }
code > span.dv { color: #dcdccc; }
code > span.bn { color: #dca3a3; }
code > span.fl { color: #c0bed1; }
code > span.ch { color: #dca3a3; }
code > span.st { color: #cc9393; }
code > span.co { color: #7f9f7f; }
code > span.ot { color: #efef8f; }
code > span.al { color: #ffcfaf; }
code > span.fu { color: #efef8f; }
code > span.er { color: #c3bf9f; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
</style>
<div class="container-fluid main-container">

<div class="navbar navbar-inverse navbar-fixed-top">
	<div class="navbar-inner">
		<div class="container">
			<button class="btn btn-navbar" type="button" data-toggle="collapse" data-target=".nav-collapse">
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a href="http://durtal.github.io" class="brand">return to RcappeR</a>
			<div class="nav-collapse collapse">
				<ul class="nav">
					<li>
						<a href="index.html">rBloodstock Home</a>
					</li>
					<li class="dropdown">
						<a href="Datasets" class="dropdown-toggle" data-toggle="dropdown">
							Datasets <b class="caret"></b>
						</a>
						<ul class="dropdown-menu">
							<li>
								<a href="tattersalls.html">Tattersalls</a>
							</li>
						</ul>
					</li>
					<li class="dropdown">
						<a href="functions" class="dropdown-toggle" data-toggle="dropdown">
							Functions <b class="caret"></b>
						</a>
						<ul class="dropdown-menu">
							<li>
								<a href="collect_tatts_sales.html">collect_tatts_sales</a>
							</li>
						</ul>
					</li>
				</ul>
			</div>
		</div>
	</div>
</div>

<div id="header">
<h1 class="title">Tattersalls</h1>
</div>


<p>There are currently (as of 30/10/14) 5 datasets with Tattersalls sales data, these are:</p>
<table>
<thead>
<tr class="header">
<th align="left">Name</th>
<th align="left">Sales included</th>
<th align="left">Dim</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">tatts_2010</td>
<td align="left"><sub>dec_mares, dec_foals, dec_yearlings, autumn_hit, breeders_flat, oct_bk3, oct_bk2, oct_bk1, sept, july, guineas, craven, feb</sub></td>
<td align="left">8346 rows, 12 cols</td>
</tr>
<tr class="even">
<td align="left">tatts_2011</td>
<td align="left"><sub>dec_mares, dec_foals, dec_yearlings, autumn_hit, breeders_flat, oct_bk3, oct_bk2, oct_bk1, sept, july, breeze_up, craven, feb</sub></td>
<td align="left">7488 rows, 12 cols</td>
</tr>
<tr class="odd">
<td align="left">tatts_2012</td>
<td align="left"><sub>dec_mares, dec_foals, dec_yearlings, nov_yearlings, autumn_hit, oct_bk3, oct_bk2, oct_bk1, sept, july, guineas_hit, guineas, craven, feb</sub></td>
<td align="left">7739 rows, 12 cols</td>
</tr>
<tr class="even">
<td align="left">tatts_2013</td>
<td align="left"><sub>dec_mares, dec_foals, dec_yearlings, nov_yearlings, autumn_hit, oct_bk4, oct_bk3, oct_bk2, oct_bk1, sept, july, guineas_hit, guineas, craven, feb</sub></td>
<td align="left">8867 rows, 12 cols</td>
</tr>
<tr class="odd">
<td align="left">tatts_2014</td>
<td align="left"><sub>oct_bk1, oct_bk2, oct_bk3, sept, july, guineas_hit, guineas, craven, feb</sub></td>
<td align="left">4064 rows, 12 cols</td>
</tr>
</tbody>
</table>
<p>There is a function to collect data from sales not included in the package, see <a href="collect_tatts_sales.html">here</a>.</p>
<p>To load a dataset:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(tatts_2010)</code></pre>
<p>Each of the 5 datasets have the same 12 variables, <code>year, sale, sale_name, lot_no, horse, sex, color, sire, dam, seller, buyer, price</code>, as can be seen in the table above, the same sales take place each year.</p>
<div id="some-analysis" class="section level3">
<h3>Some Analysis</h3>
<p>It is easy to combine the 5 datasets, such as:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(tatts_2010, tatts_2011, tatts_2012, tatts_2013, tatts_2014)

<span class="co"># combine all 5 datasets into one large dataset</span>
tattersalls &lt;-<span class="st"> </span><span class="kw">rbind</span>(tatts_2010, tatts_2011, tatts_2012, tatts_2013, tatts_2014)
<span class="co"># clean workspace</span>
<span class="kw">rm</span>(tatts_2010, tatts_2011, tatts_2012, tatts_2013, tatts_2014)</code></pre>
<p>The new <code>tattersalls</code> dataset has 34311 rows and 12 columns, the <code>sale_name</code> variable can serve as an individual sale (so it includes the year of the sale, eg. <strong>feb_2010</strong>), while the <code>sale</code> variable will match across multiple years.</p>
<p>Loading other libraries <code>dplyr</code> and <code>ggplot2</code> we can quickly analyse data:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">library</span>(ggplot2)</code></pre>
<p>The average price of lots in each sale across multiple years:</p>
<pre class="sourceCode r"><code class="sourceCode r">sale_summaries &lt;-<span class="st"> </span>tattersalls %&gt;%
<span class="st">    </span><span class="kw">group_by</span>(sale, year) %&gt;%
<span class="st">    </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>(),
              <span class="dt">mean =</span> <span class="kw">mean</span>(price, <span class="dt">na.rm=</span>T))

<span class="kw">ggplot</span>(sale_summaries, <span class="kw">aes</span>(<span class="dt">x=</span>year, <span class="dt">y=</span>mean)) +
<span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;#D9220F&quot;</span>) +
<span class="st">    </span><span class="kw">theme_bw</span>() +
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) +
<span class="st">    </span><span class="kw">facet_wrap</span>(~sale)</code></pre>
<p><img src="tattersalls_files/figure-html/unnamed-chunk-5-1.png" title="" alt="" width="864" style="display: block; margin: auto;" /></p>
<p>One thing stands out immediately from the plots above, don’t go to October Book 1 unless you have deep pockets, the average price of lots has doubled from 96,001 Guineas in 2010 to 188,068 Guineas in 2013 (2014 isn’t included in the <code>tatts_2014</code> dataset yet). The Craven sale has also seen a small increase over recent years, but prices are in other sales appear to be very consistent.</p>
<p>We can also find the 20 sires with the highest average price over the 5 years:</p>
<pre class="sourceCode r"><code class="sourceCode r">tattersalls %&gt;%
<span class="st">    </span><span class="kw">group_by</span>(sire) %&gt;%
<span class="st">    </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>(),
              <span class="dt">mean =</span> <span class="kw">mean</span>(price, <span class="dt">na.rm=</span>T),
              <span class="dt">sd =</span> <span class="kw">sd</span>(price, <span class="dt">na.rm=</span>T),
              <span class="dt">min =</span> <span class="kw">min</span>(price, <span class="dt">na.rm=</span>T),
              <span class="dt">max =</span> <span class="kw">max</span>(price, <span class="dt">na.rm=</span>T)) %&gt;%
<span class="st">    </span><span class="kw">filter</span>(n &gt;=<span class="st"> </span><span class="dv">50</span>) %&gt;%
<span class="st">    </span><span class="kw">arrange</span>(<span class="kw">desc</span>(mean)) %&gt;%
<span class="st">    </span><span class="kw">head</span>(<span class="dv">20</span>)</code></pre>
<pre><code>## Source: local data frame [20 x 6]
## 
##                       sire   n      mean        sd   min     max
## 1      sea the stars (ire) 140 224100.92 153564.74 16000  650000
## 2            galileo (ire) 517 221113.08 422710.12   800 5000000
## 3           danehill (usa)  50 126065.12 387885.12  2000 2400000
## 4       new approach (ire) 213 115085.23 112242.00  2500  600000
## 5            montjeu (ire) 295 109844.84 160582.97   800  850000
## 6     sadler&#39;s wells (usa) 140 104800.88 212350.10  1000 1700000
## 7             dubawi (ire) 349  99800.00 172610.52   800 1600000
## 8             monsun (ger)  75  96396.67 113962.25  2000  600000
## 9         oasis dream (gb) 529  95668.03 146239.91   800 1100000
## 10      fastnet rock (aus) 141  90769.91  84839.98  4000  540000
## 11            dansili (gb) 394  86534.67 191951.69   800 2700000
## 12 invincible spirit (ire) 599  82369.38 132773.44   800 2100000
## 13   danehill dancer (ire) 468  80064.41 229364.46   800 4000000
## 14      raven&#39;s pass (usa) 130  78780.34 101886.66   800  800000
## 15            pivotal (gb) 562  74053.33 236658.18   800 4700000
## 16       dream ahead (usa)  57  73340.00  77357.27  3000  400000
## 17       poet&#39;s voice (gb)  77  73014.49  90171.49  3500  525000
## 18         shamardal (usa) 446  70400.29 120847.71   800 1700000
## 19    rip van winkle (ire) 133  69230.43  62506.29  4000  400000
## 20              arch (usa)  80  67898.31  82438.42  2000  300000</code></pre>
<p><strong>Sea The Stars</strong> is top of the list, his progeny costing a cool 212,922 Guineas on average, Galileo is a close second, with a large gap down to Danehill. Perhaps more interesting than Sea The Stars topping Galileo is the <em>standard deviation</em> of their prices, Sea The Stars with a much smaller <strong>sd</strong> perhaps suggests buyers believe his progeny will prove to be successful (see Taghrooda), but are still showing some restraint and aren’t quite willing to part with the big sums seen with Galileo, whose most expensive sale fetched 9 times the most expensive Sea The Stars sale.</p>
<p>It’s also possible to look at the buyers or agents with the highest average price paid over the 5years.</p>
<pre class="sourceCode r"><code class="sourceCode r">tattersalls %&gt;%
<span class="st">    </span><span class="kw">group_by</span>(buyer) %&gt;%
<span class="st">    </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>(),
              <span class="dt">mean =</span> <span class="kw">mean</span>(price, <span class="dt">na.rm=</span>T),
              <span class="dt">sd =</span> <span class="kw">sd</span>(price, <span class="dt">na.rm=</span>T),
              <span class="dt">min =</span> <span class="kw">min</span>(price, <span class="dt">na.rm=</span>T),
              <span class="dt">max =</span> <span class="kw">max</span>(price, <span class="dt">na.rm=</span>T)) %&gt;%
<span class="st">    </span><span class="kw">filter</span>(n &gt;=<span class="st"> </span><span class="dv">50</span>) %&gt;%
<span class="st">    </span><span class="kw">arrange</span>(<span class="kw">desc</span>(mean)) %&gt;%
<span class="st">    </span><span class="kw">head</span>(<span class="dv">20</span>)</code></pre>
<pre><code>## Source: local data frame [20 x 6]
## 
##                            buyer   n      mean        sd   min     max
## 1                   demi o&#39;byrne  50 344060.00 267094.37  6000 1300000
## 2       john ferguson bloodstock 291 217340.21 305347.10 25000 4000000
## 3            j warren bloodstock  92 163744.57 144386.32 16500  680000
## 4        shadwell estate company 250 163488.00 130553.20 35000 1100000
## 5     c gordon-watson bloodstock 270 149084.44 190080.48   800 1700000
## 6           mccalmont bloodstock  51 130774.51 219594.75  6500 1150000
## 7             cheveley park stud  61 122098.36 104013.89 32000  535000
## 8       david redvers bloodstock 197 121993.40 225457.93  5000 2500000
## 9         john warren bloodstock  93 118645.16  95735.10 11000  600000
## 10                  dwayne woods  60  95391.67  78483.30  3000  450000
## 11          blandford bloodstock 430  79854.88 103871.98   800  925000
## 12             mrs a skiffington  57  79289.47  78058.53  3000  400000
## 13     richard frisby bloodstock  86  74308.14  84808.23  2000  370000
## 14 peter &amp; ross doyle bloodstock 388  72782.73  77984.78   800  800000
## 15     anthony stroud bloodstock 212  71264.15  68030.93   800  380000
## 16     brian grassick bloodstock  50  67214.00  62857.31  2200  360000
## 17     stephen hillen bloodstock 173  66624.28 166552.07  3000 2100000
## 18         hugo merry bloodstock 142  66446.48  88738.11  1700  675000
## 19               jeremy brummitt  64  64257.81  79608.57  6500  475000
## 20               sackvilledonald 220  61468.18  55066.49  2500  460000</code></pre>
<p>Demi O’Byrne (an agent associated with Coolmore) isn’t as active as others in the top 5, with just 50 purchases, but the average price he pays is almost double that of John Ferguson (links with Godolphin).</p>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>


</body>
</html>
